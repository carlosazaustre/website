---
title: "Browserify. Desarrollando tu Frontend como en Node.js"
date: "2015-03-12"
tags:
  - "游눹 Desarrollo"
---

[Browserify](http://browserify.org/) es una librer칤a de Node.js, escrita por [substack](https://www.npmjs.com/~substack),
uno de los mayores contribuidores al core de Node.js y con mayor n칰mero de m칩dulos publicados en NPM.

![browserify](/images/browserify-desarrollando-tu-frontend-como-en-node-js/687474703a2f2f737562737461636b2e6e65742f696d616765732f62726f777365726966795f6c6f676f2e706e67.png)
Nos permite escribir c칩digo JavaScript del cliente, como si estuvi칠semos programando en Node.js,
es decir, como por ahora no tenemos m칩dulos de forma nativa en JavaScript (hasta que [se implante el est치ndar ECMAScript6](/ecmascript6/)
que si los trae) hay librer칤as que se encargan de imitar ese comportamiento (Caso de Require.js hace un tiempo).

Con esta librer칤a, podemos instalar m칩dulos para el cliente, con NPM, al igual que hac칤amos con bower, pero ahora, podemos
llamarlos desde nuestro c칩digo con la palabra reservada `require`, al igual que en Node.js

Y tambi칠n nos permite tener un s칩lo archivo `.js` en el cliente, ya de inicio, olvid치ndonos de tener que importar todas las librer칤as
y scripts utilizados en el HTML con `<script src="..."></script>` y luego tener que concatenar etc...

Tambi칠n nos permite crear nuestros propios m칩dulos con `module.exports` y llamarlos de nuevo desde nuestro c칩digo con `require`.

En este art칤culo vamos a ver como ser칤a un ejemplo sencillo utilizando una libreria externa como `jQuery` instalada a trav칠s de NPM,
y como crear nuestro propio m칩dulo y utilizarlo dentro de nuestra aplicaci칩n. Para todo ello emplearemos Node.js como servidor y Gulp con algunos plugins para automatizar el proceso.

### Configuraci칩n de Gulp

Instalamos los siguientes m칩dulos y plugins para automatizar algunas tareas.

```shell
$ npm install --save-dev gulp
$ npm install --save-dev gulp-uglify
$ npm install --save-dev browserify
$ npm install --save-dev vinyl-source-stream
$ npm install --save-dev vinyl-buffer
```

Esta ser치 la tarea que crea el fichero `bundle.js` donde est치 el codigo fuente completo de la parte cliente, ya traducido para que
funcione en el navegador, ya que los navegadores no entienden los `require` ni los `module.exports`.

```js
gulp.task("browserify", function () {
  return browserify("./source/scripts/app.main.js")
    .bundle()
    .pipe(source("bundle.js"))
    .pipe(buffer())
    .pipe(uglify())
    .pipe(gulp.dest("./public/js"));
});
```

El fichero principal dentro de nuestros fuentes es `app.main.js`, desde ah칤 se llama al resto de modulos y librer칤as externas utilizadas
y el metodo `bundle()` lo compila.

Con `buffer()` del plugin `vinyl-buffer` y `source()` del plugin `vinyl-source-stream` conseguimos poder utilizar el fichero
`bundle.js` generado para aplicarle un `uglify` o lo que se nos ocurra. Si le aplicacamos `uglify` despues del `bundle()` dar치 error
porque por asincron칤a, a칰n no ha sido generado el fichero cuando queremos acceder a el.

### Instalando librer칤as para el Frontend con NPM

Ahora vamos a Instalar librer칤as cliente desde NPM, Node Package Manager, el repositorio de m칩dulos de Node.js.

Para instalar por ejemplo, la librer칤a de jQuery, lo hacemos de la siguiente manera:

```shell
$ npm install jquery
```

En nuestro index.html (ya sea servido por Node.js, Apache, Nginx, etc) debe incluir el script `bundle.js` generado por Browserify

```html
<!DOCTYPE html>
<html>
  <head>
    <title>Browserify Playground</title>
  </head>
  <body>
    <h1>Hola Mundo</h1>
    <script src="/static/js/bundle.js"></script>
  </body>
</html>
```

Adem치s para este ejemplo, hemos a침adido un `h1` con el texto _Hola Mundo_.

Ahora pasamos a nuestro c칩digo fuente JavaScript, el fichero `app.main.js` llamar치 al m칩dulo de jQuery con `require('jquery')` y podremos usarlo.

Este script 칰nicamente buscar치 el elemento `h1` y cambiar치 su texto por _Hello Browserify_

```js
// source/scripts/app.main.js
var $ = require("jquery");
$("h1").html("Hola Browserify");
```

El resultado que veremos en el navegador ser치 el siguiente:
![hola browserify](/images/browserify-desarrollando-tu-frontend-como-en-node-js/Screen-Shot-2015-03-11-at-20-45-18.png)

Para conseguir este resultado, hay que correr las tareas que hemos configurado en el `Gulpfile.js`

```shell
$ gulp build
$ gulp
```

### Integrando nuestros propios m칩dulos

Voy a crear un fichero `app.persona.js` como m칩dulo para ver como se exportar칤a e importar칤a en nuestra aplicaci칩n con _browserify_

```js
// source/scripts/app.persona.js

var Persona = function (nombre, edad) {
  this.nombre = nombre;
  this.edad = edad;

  var self = this;

  return {
    saludar: function () {
      alert("Hola, mi nombre es " + self.nombre);
    },
    presentar: function () {
      alert("Tengo " + self.edad + " a침os.");
    },
  };
};

module.exports = Persona;
```

Exportamos la variable `Persona` como m칩dulo, y que devuelve 2 funciones, `saludar` y `presentar`,
que son las 칰nicas que podremos utilizar cuando las llamemos desde `app.main.js`

```js
var $ = require("jquery");
var persona = require("./app.persona");

$("h1").html("Hola Browserify");

var carlos = new persona("Carlos", 30);
carlos.saludar();
carlos.presentar();
```

Importamos el m칩dulo recien creado con `require('./app.persona')` indic치ndole la ruta donde est치 el archivo.

Creamos un objeto `persona` en la variable `carlos`, le pasamos los par치metros `Carlos` y `30` como nombre y edad.
Llamamos a las funciones `saludar()` y `presentar()` que mostrar치n una alerta JavaScript como las siguientes:

![saludar](/images/browserify-desarrollando-tu-frontend-como-en-node-js/Screen-Shot-2015-03-11-at-23-35-04.png)

![presentar](/images/browserify-desarrollando-tu-frontend-como-en-node-js/Screen-Shot-2015-03-11-at-23-35-09.png)

De esta manera, con `Browserify`, podemos programar el JavaScript del Frontend como en el backend con Node.js, pudiendo incluso
utilizar librer칤as no disponibles para el navegador. Y adem치s compilar todo en un 칰nico fichero y no tener que enlazar los scripts en el HTML, salvo el `bundle.js`

![chuck-norris-aproved](http://www.gifbin.com/bin/1237811519_chuck-norris-approves.gif)

En el siguiente enlace tienes acceso al c칩digo utilizado en este ejemplo, para que lo puedas testear.

> [github.com/carlosazaustre/browserify-example](https://github.com/carlosazaustre/browserify-example)
